"""Заполнение раздела "Справка" (SystemSetting.help_text).
Запускайте один раз или при обновлении текста справки.
"""
from backend.app import create_app, db  # type: ignore
from backend.app.models import SystemSetting  # type: ignore

HELP_TEXT = (
    "MUIVesg — учебный проект ВКР для обмена и ответственного обращения с вещами.\n\n"
    "Основные возможности:\n"
    "- Создание объявлений: передача, обмен, продажа.\n"
    "- Пожертвования: фиксация передачи вещи.\n"
    "- Переработка/утилизация: отметка операций, рекомендации по классам опасности.\n"
    "- Поиск и фильтры по категориям и статусам.\n"
    "- Личный кабинет: управление объявлениями и история операций.\n\n"
    "Роли пользователей:\n"
    "- Пользователь: создание объявлений, инициирование сделок.\n"
    "- Менеджер/модератор: модерация объявлений и сделок, отчёты.\n"
    "- Администратор: управление пользователями и справочниками.\n\n"
    "Подсказки:\n"
    "- Для обмена выберите свою вещь в карточке интересующей вещи и отправьте заявку.\n"
    "- Для пожертвования владелец подтверждает передачу в карточке своей вещи.\n"
    "- Для переработки укажите способ и локацию при отметке операции.\n\n"
    "Контакты и авторство:\n"
    "- Проект выполнен в рамках учебного задания. Текст справки можно отредактировать администратором в разделе 'Редактор справки'.\n"
)


def main():
    app = create_app()
    with app.app_context():
        rec = SystemSetting.query.filter_by(key="help_text").first()
        if rec is None:
            rec = SystemSetting(key="help_text")
            db.session.add(rec)
        rec.value = HELP_TEXT
        rec.description = "Справочная информация"
        db.session.commit()
        print("[OK] Справка заполнена.")


if __name__ == "__main__":
    main()
